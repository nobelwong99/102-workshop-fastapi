<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Modern Task Manager</title>
		<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" />
		<style>
			:root {
				--primary-color: #4f46e5;
				--primary-dark: #4338ca;
				--secondary-color: #06b6d4;
				--success-color: #10b981;
				--warning-color: #f59e0b;
				--danger-color: #ef4444;
				--light-gray: #f8fafc;
				--medium-gray: #64748b;
				--dark-gray: #1e293b;
				--white: #ffffff;
				--shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
				--shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
				--shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
				--shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
				--border-radius: 0.75rem;
				--transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
			}

			* {
				margin: 0;
				padding: 0;
				box-sizing: border-box;
			}

			body {
				font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
				background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 25%, #1d4ed8 50%, #2563eb 75%, #1e40af 100%);
				background-size: 400% 400%;
				animation: gradientShift 15s ease infinite;
				min-height: 100vh;
				color: var(--dark-gray);
				line-height: 1.6;
			}

			@keyframes gradientShift {
				0% {
					background-position: 0% 50%;
				}
				50% {
					background-position: 100% 50%;
				}
				100% {
					background-position: 0% 50%;
				}
			}

			.container {
				max-width: 1400px;
				margin: 0 auto;
				padding: 1rem;
			}

			.header {
				text-align: center;
				margin-bottom: 2rem;
				padding: 2rem 1.5rem;
				background: rgba(255, 255, 255, 0.95);
				backdrop-filter: blur(20px);
				border-radius: var(--border-radius);
				box-shadow: var(--shadow-xl);
				border: 1px solid rgba(255, 255, 255, 0.2);
			}

			.header h1 {
				font-size: clamp(2.5rem, 5vw, 4rem);
				font-weight: 800;
				background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
				-webkit-background-clip: text;
				-webkit-text-fill-color: transparent;
				background-clip: text;
				margin-bottom: 1rem;
			}

			.header p {
				font-size: 1.25rem;
				color: var(--medium-gray);
				max-width: 600px;
				margin: 0 auto;
			}

			.stats-grid {
				display: grid;
				grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
				gap: 1rem;
				margin-bottom: 1.5rem;
			}

			.stat-card {
				background: rgba(255, 255, 255, 0.95);
				backdrop-filter: blur(20px);
				padding: 1.5rem;
				border-radius: var(--border-radius);
				box-shadow: var(--shadow-lg);
				border: 1px solid rgba(255, 255, 255, 0.2);
				text-align: center;
				transition: var(--transition);
			}

			.stat-card:hover {
				transform: translateY(-4px);
				box-shadow: var(--shadow-xl);
			}

			.stat-icon {
				font-size: 2.5rem;
				margin-bottom: 1rem;
				display: block;
			}

			.stat-card.total .stat-icon {
				color: var(--primary-color);
			}
			.stat-card.pending .stat-icon {
				color: var(--warning-color);
			}
			.stat-card.completed .stat-icon {
				color: var(--success-color);
			}

			.stat-number {
				font-size: 2.5rem;
				font-weight: 800;
				margin-bottom: 0.5rem;
				display: block;
			}

			.stat-label {
				color: var(--medium-gray);
				font-weight: 600;
				text-transform: uppercase;
				letter-spacing: 0.05em;
				font-size: 0.875rem;
			}

			.main-grid {
				display: grid;
				grid-template-columns: 1fr 2fr;
				gap: 1rem;
				align-items: start;
			}

			.sidebar {
				position: sticky;
				top: 1rem;
			}

			.card {
				background: rgba(255, 255, 255, 0.95);
				backdrop-filter: blur(20px);
				border-radius: var(--border-radius);
				box-shadow: var(--shadow-lg);
				border: 1px solid rgba(255, 255, 255, 0.2);
				overflow: hidden;
			}

			.card-header {
				padding: 1rem 1.5rem;
				border-bottom: 1px solid #e2e8f0;
				background: linear-gradient(135deg, rgba(79, 70, 229, 0.1), rgba(6, 182, 212, 0.1));
			}

			.card-title {
				font-size: 1.5rem;
				font-weight: 700;
				color: var(--dark-gray);
				margin: 0;
				display: flex;
				align-items: center;
				gap: 0.75rem;
			}

			.card-body {
				padding: 1.5rem;
			}

			.form-group {
				margin-bottom: 1rem;
			}

			.form-row {
				display: grid;
				grid-template-columns: 1fr 1fr;
				gap: 0.75rem;
				margin-bottom: 1rem;
			}

			label {
				display: block;
				margin-bottom: 0.5rem;
				font-weight: 600;
				color: var(--dark-gray);
				font-size: 0.875rem;
				text-transform: uppercase;
				letter-spacing: 0.05em;
			}

			input,
			textarea,
			select {
				width: 100%;
				padding: 0.875rem 1rem;
				border: 2px solid #e2e8f0;
				border-radius: 0.5rem;
				font-size: 1rem;
				transition: var(--transition);
				background: var(--white);
				font-family: inherit;
			}

			input:focus,
			textarea:focus,
			select:focus {
				outline: none;
				border-color: var(--primary-color);
				box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
			}

			textarea {
				resize: vertical;
				min-height: 120px;
			}

			.btn {
				display: inline-flex;
				align-items: center;
				justify-content: center;
				gap: 0.5rem;
				padding: 0.875rem 1.5rem;
				border: none;
				border-radius: 0.5rem;
				font-size: 0.875rem;
				font-weight: 600;
				text-transform: uppercase;
				letter-spacing: 0.05em;
				cursor: pointer;
				transition: var(--transition);
				text-decoration: none;
				font-family: inherit;
			}

			.btn:disabled {
				opacity: 0.6;
				cursor: not-allowed;
			}

			.btn-primary {
				background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
				color: var(--white);
			}

			.btn-primary:hover:not(:disabled) {
				transform: translateY(-2px);
				box-shadow: var(--shadow-lg);
			}

			.btn-secondary {
				background: var(--medium-gray);
				color: var(--white);
			}

			.btn-secondary:hover:not(:disabled) {
				background: #475569;
				transform: translateY(-2px);
			}

			.btn-success {
				background: var(--success-color);
				color: var(--white);
			}

			.btn-success:hover:not(:disabled) {
				background: #059669;
				transform: translateY(-2px);
			}

			.btn-warning {
				background: var(--warning-color);
				color: var(--white);
			}

			.btn-warning:hover:not(:disabled) {
				background: #d97706;
				transform: translateY(-2px);
			}

			.btn-danger {
				background: var(--danger-color);
				color: var(--white);
			}

			.btn-danger:hover:not(:disabled) {
				background: #dc2626;
				transform: translateY(-2px);
			}

			.btn-group {
				display: flex;
				gap: 0.5rem;
				flex-wrap: wrap;
				margin-bottom: 1rem;
			}

			.btn-sm {
				padding: 0.5rem 1rem;
				font-size: 0.75rem;
			}

			.search-filter-section {
				margin-bottom: 1rem;
			}

			.search-box {
				position: relative;
				margin-bottom: 1rem;
			}

			.search-box input {
				padding-left: 3rem;
			}

			.search-icon {
				position: absolute;
				left: 1rem;
				top: 50%;
				transform: translateY(-50%);
				color: var(--medium-gray);
			}

			.filter-tabs {
				display: flex;
				background: #f1f5f9;
				border-radius: 0.75rem;
				padding: 0.25rem;
				margin-bottom: 1rem;
			}

			.filter-tab {
				flex: 1;
				padding: 0.75rem 1rem;
				border: none;
				background: transparent;
				border-radius: 0.5rem;
				font-weight: 600;
				cursor: pointer;
				transition: var(--transition);
				font-size: 0.875rem;
			}

			.filter-tab.active {
				background: var(--white);
				color: var(--primary-color);
				box-shadow: var(--shadow-sm);
			}

			.tasks-container {
				min-height: 400px;
			}

			.tasks-grid {
				display: grid;
				gap: 1rem;
			}

			.task-card {
				background: var(--white);
				border-radius: var(--border-radius);
				box-shadow: var(--shadow-md);
				border: 1px solid #e2e8f0;
				transition: var(--transition);
				overflow: hidden;
			}

			.task-card:hover {
				transform: translateY(-4px);
				box-shadow: var(--shadow-xl);
			}

			.task-card.completed {
				border-left: 4px solid var(--success-color);
				background: linear-gradient(135deg, rgba(16, 185, 129, 0.02), rgba(16, 185, 129, 0.05));
			}

			.task-card.pending {
				border-left: 4px solid var(--warning-color);
				background: linear-gradient(135deg, rgba(245, 158, 11, 0.02), rgba(245, 158, 11, 0.05));
			}

			.task-header {
				padding: 1rem 1rem 0;
				display: flex;
				justify-content: space-between;
				align-items: flex-start;
				gap: 0.75rem;
			}

			.task-id {
				background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
				color: var(--white);
				padding: 0.25rem 0.75rem;
				border-radius: 1rem;
				font-size: 0.75rem;
				font-weight: 700;
				text-transform: uppercase;
				letter-spacing: 0.05em;
			}

			.task-status {
				display: flex;
				align-items: center;
				gap: 0.5rem;
				padding: 0.375rem 0.875rem;
				border-radius: 1rem;
				font-size: 0.75rem;
				font-weight: 600;
				text-transform: uppercase;
				letter-spacing: 0.05em;
			}

			.task-status.completed {
				background: rgba(16, 185, 129, 0.1);
				color: var(--success-color);
			}

			.task-status.pending {
				background: rgba(245, 158, 11, 0.1);
				color: var(--warning-color);
			}

			.task-body {
				padding: 1rem;
			}

			.task-title {
				font-size: 1.25rem;
				font-weight: 700;
				color: var(--dark-gray);
				margin-bottom: 0.75rem;
				line-height: 1.4;
			}

			.task-description {
				color: var(--medium-gray);
				line-height: 1.6;
				margin-bottom: 1rem;
			}

			.task-actions {
				display: flex;
				gap: 0.5rem;
				flex-wrap: wrap;
			}

			.task-meta {
				display: flex;
				align-items: center;
				gap: 0.75rem;
				padding: 0.75rem 1rem;
				background: #f8fafc;
				border-top: 1px solid #e2e8f0;
				font-size: 0.875rem;
				color: var(--medium-gray);
			}

			.loading {
				display: flex;
				flex-direction: column;
				align-items: center;
				justify-content: center;
				padding: 2rem 1rem;
				color: var(--medium-gray);
			}

			.spinner {
				width: 3rem;
				height: 3rem;
				border: 3px solid #e2e8f0;
				border-top: 3px solid var(--primary-color);
				border-radius: 50%;
				animation: spin 1s linear infinite;
				margin-bottom: 1rem;
			}

			@keyframes spin {
				0% {
					transform: rotate(0deg);
				}
				100% {
					transform: rotate(360deg);
				}
			}

			.empty-state {
				text-align: center;
				padding: 2rem 1rem;
				color: var(--medium-gray);
			}

			.empty-state i {
				font-size: 4rem;
				margin-bottom: 1rem;
				color: #cbd5e1;
			}

			.empty-state h3 {
				font-size: 1.5rem;
				margin-bottom: 0.5rem;
				color: var(--dark-gray);
			}

			.message {
				padding: 0.75rem 1rem;
				border-radius: 0.5rem;
				margin-bottom: 1rem;
				font-weight: 500;
				display: flex;
				align-items: center;
				gap: 0.5rem;
				animation: slideIn 0.3s ease;
			}

			@keyframes slideIn {
				from {
					transform: translateY(-1rem);
					opacity: 0;
				}
				to {
					transform: translateY(0);
					opacity: 1;
				}
			}

			.message.success {
				background: rgba(16, 185, 129, 0.1);
				color: var(--success-color);
				border: 1px solid rgba(16, 185, 129, 0.2);
			}

			.message.error {
				background: rgba(239, 68, 68, 0.1);
				color: var(--danger-color);
				border: 1px solid rgba(239, 68, 68, 0.2);
			}

			.toast-container {
				position: fixed;
				top: 1rem;
				right: 1rem;
				z-index: 1000;
				display: flex;
				flex-direction: column;
				gap: 0.5rem;
			}

			.toast {
				background: var(--white);
				border-radius: 0.5rem;
				padding: 0.75rem 1rem;
				box-shadow: var(--shadow-xl);
				border: 1px solid #e2e8f0;
				min-width: 280px;
				animation: toastIn 0.3s ease;
				display: flex;
				align-items: center;
				gap: 0.5rem;
			}

			.toast.success {
				border-left: 4px solid var(--success-color);
			}
			.toast.error {
				border-left: 4px solid var(--danger-color);
			}

			@keyframes toastIn {
				from {
					transform: translateX(100%);
					opacity: 0;
				}
				to {
					transform: translateX(0);
					opacity: 1;
				}
			}

			.modal {
				position: fixed;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				background: rgba(0, 0, 0, 0.5);
				backdrop-filter: blur(4px);
				display: none;
				align-items: center;
				justify-content: center;
				z-index: 1000;
				animation: fadeIn 0.3s ease;
			}

			.modal.show {
				display: flex;
			}

			@keyframes fadeIn {
				from {
					opacity: 0;
				}
				to {
					opacity: 1;
				}
			}

			.modal-content {
				background: var(--white);
				border-radius: var(--border-radius);
				box-shadow: var(--shadow-xl);
				max-width: 500px;
				width: 90%;
				max-height: 90vh;
				overflow-y: auto;
				animation: modalIn 0.3s ease;
			}

			@keyframes modalIn {
				from {
					transform: translateY(-2rem) scale(0.95);
					opacity: 0;
				}
				to {
					transform: translateY(0) scale(1);
					opacity: 1;
				}
			}

			.modal-header {
				padding: 1rem 1.5rem;
				border-bottom: 1px solid #e2e8f0;
				display: flex;
				justify-content: space-between;
				align-items: center;
			}

			.modal-title {
				font-size: 1.25rem;
				font-weight: 700;
				margin: 0;
			}

			.modal-close {
				background: none;
				border: none;
				font-size: 1.5rem;
				cursor: pointer;
				color: var(--medium-gray);
				padding: 0;
				width: 2rem;
				height: 2rem;
				display: flex;
				align-items: center;
				justify-content: center;
				border-radius: 0.25rem;
				transition: var(--transition);
			}

			.modal-close:hover {
				background: #f1f5f9;
			}

			.modal-body {
				padding: 1.5rem;
			}

			@media (max-width: 1024px) {
				.main-grid {
					grid-template-columns: 1fr;
					gap: 1rem;
				}

				.sidebar {
					position: static;
				}
			}

			@media (max-width: 768px) {
				.container {
					padding: 0.75rem;
				}

				.header {
					padding: 1.5rem 1rem;
					margin-bottom: 1rem;
				}

				.header h1 {
					font-size: 2rem;
				}

				.stats-grid {
					grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
					gap: 0.75rem;
				}

				.card-body {
					padding: 1rem;
				}

				.form-row {
					grid-template-columns: 1fr;
					gap: 0;
				}

				.btn-group {
					flex-direction: column;
				}

				.filter-tabs {
					flex-direction: column;
					gap: 0.25rem;
				}

				.toast {
					min-width: auto;
					right: 0.75rem;
					left: 0.75rem;
				}

				.modal-content {
					margin: 0.75rem;
					width: calc(100% - 1.5rem);
				}

				.toast-container {
					left: 0.75rem;
					right: 0.75rem;
				}
			}
		</style>
	</head>
	<body>
		<div class="container">
			<!-- Header -->
			<div class="header">
				<h1><i class="fas fa-tasks"></i> TaskFlow Pro</h1>
				<p>Experience next-level task management with our modern, intuitive interface</p>
			</div>

			<!-- Statistics Cards -->
			<div class="stats-grid">
				<div class="stat-card total">
					<i class="fas fa-list stat-icon"></i>
					<span class="stat-number" id="totalTasks">0</span>
					<span class="stat-label">Total Tasks</span>
				</div>
				<div class="stat-card pending">
					<i class="fas fa-clock stat-icon"></i>
					<span class="stat-number" id="pendingTasks">0</span>
					<span class="stat-label">Pending</span>
				</div>
				<div class="stat-card completed">
					<i class="fas fa-check-circle stat-icon"></i>
					<span class="stat-number" id="completedTasks">0</span>
					<span class="stat-label">Completed</span>
				</div>
			</div>

			<!-- Main Content Grid -->
			<div class="main-grid">
				<!-- Sidebar with Forms -->
				<div class="sidebar">
					<!-- Create Task Card -->
					<div class="card">
						<div class="card-header">
							<h2 class="card-title">
								<i class="fas fa-plus-circle"></i>
								Create New Task
							</h2>
						</div>
						<div class="card-body">
							<form id="createTaskForm">
								<div class="form-row">
									<div class="form-group">
										<label for="taskId">Task ID</label>
										<input type="number" id="taskId" name="id" placeholder="Enter ID" min="1" />
									</div>
									<div class="form-group">
										<label for="autoId">ID Mode</label>
										<select id="autoId" name="autoId">
											<option value="true">Auto Generate</option>
											<option value="false">Custom ID</option>
										</select>
									</div>
								</div>
								<div class="form-group">
									<label for="taskTitle">Title *</label>
									<input type="text" id="taskTitle" name="title" required placeholder="What needs to be done?" />
								</div>
								<div class="form-group">
									<label for="taskDescription">Description *</label>
									<textarea
										id="taskDescription"
										name="description"
										required
										placeholder="Describe the task in detail..."
									></textarea>
								</div>
								<div class="form-group">
									<label for="taskCompleted">Status</label>
									<select id="taskCompleted" name="completed">
										<option value="false">Pending</option>
										<option value="true">Completed</option>
									</select>
								</div>
								<button type="submit" class="btn btn-primary" style="width: 100%">
									<i class="fas fa-plus"></i>
									Create Task
								</button>
							</form>
						</div>
					</div>

					<!-- Quick Actions Card -->
					<div class="card" style="margin-top: 1.5rem">
						<div class="card-header">
							<h2 class="card-title">
								<i class="fas fa-bolt"></i>
								Quick Actions
							</h2>
						</div>
						<div class="card-body">
							<div style="display: flex; flex-direction: column; gap: 0.75rem">
								<button class="btn btn-secondary" onclick="markAllCompleted()">
									<i class="fas fa-check-double"></i>
									Mark All Complete
								</button>
								<button class="btn btn-warning" onclick="markAllPending()">
									<i class="fas fa-undo"></i>
									Mark All Pending
								</button>
								<button class="btn btn-danger" onclick="deleteAllCompleted()">
									<i class="fas fa-trash-alt"></i>
									Delete Completed
								</button>
								<button class="btn btn-primary" onclick="exportTasks()">
									<i class="fas fa-download"></i>
									Export Tasks
								</button>
							</div>
						</div>
					</div>
				</div>

				<!-- Main Tasks Area -->
				<div>
					<!-- Search and Filter Section -->
					<div class="card">
						<div class="card-header">
							<h2 class="card-title">
								<i class="fas fa-search"></i>
								Find & Filter Tasks
							</h2>
						</div>
						<div class="card-body">
							<div class="search-filter-section">
								<div class="search-box">
									<i class="fas fa-search search-icon"></i>
									<input type="text" id="searchInput" placeholder="Search tasks by title or description..." />
								</div>
								<div class="filter-tabs">
									<button class="filter-tab active" data-filter="all"><i class="fas fa-list"></i> All Tasks</button>
									<button class="filter-tab" data-filter="pending"><i class="fas fa-clock"></i> Pending</button>
									<button class="filter-tab" data-filter="completed"><i class="fas fa-check"></i> Completed</button>
								</div>
								<div class="btn-group">
									<button class="btn btn-primary btn-sm" onclick="loadTasks()">
										<i class="fas fa-sync-alt"></i>
										Refresh
									</button>
									<button class="btn btn-secondary btn-sm" onclick="sortTasks('id')">
										<i class="fas fa-sort-numeric-down"></i> Sort by ID
									</button>
									<button class="btn btn-secondary btn-sm" onclick="sortTasks('title')">
										<i class="fas fa-sort-alpha-down"></i> Sort by Title
									</button>
								</div>
							</div>
						</div>
					</div>

					<!-- Tasks Display -->
					<div class="card" style="margin-top: 1.5rem">
						<div class="card-header">
							<h2 class="card-title">
								<i class="fas fa-tasks"></i>
								Your Tasks
								<span id="taskCount" style="font-size: 0.875rem; font-weight: 500; color: var(--medium-gray)"></span>
							</h2>
						</div>
						<div class="card-body">
							<div class="tasks-container">
								<div id="tasksContainer">
									<div class="loading">
										<div class="spinner"></div>
										<p>Loading your tasks...</p>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>

		<!-- Toast Container -->
		<div class="toast-container" id="toastContainer"></div>

		<!-- Edit Task Modal -->
		<div class="modal" id="editModal">
			<div class="modal-content">
				<div class="modal-header">
					<h3 class="modal-title">
						<i class="fas fa-edit"></i>
						Edit Task
					</h3>
					<button class="modal-close" onclick="closeEditModal()">
						<i class="fas fa-times"></i>
					</button>
				</div>
				<div class="modal-body">
					<form id="updateTaskForm">
						<input type="hidden" id="updateTaskCurrentId" name="currentId" />
						<div class="form-row">
							<div class="form-group">
								<label for="updateTaskId">Task ID</label>
								<input type="number" id="updateTaskId" name="id" min="1" />
							</div>
							<div class="form-group">
								<label for="updateTaskCompleted">Status</label>
								<select id="updateTaskCompleted" name="completed">
									<option value="false">Pending</option>
									<option value="true">Completed</option>
								</select>
							</div>
						</div>
						<div class="form-group">
							<label for="updateTaskTitle">Title *</label>
							<input type="text" id="updateTaskTitle" name="title" required />
						</div>
						<div class="form-group">
							<label for="updateTaskDescription">Description *</label>
							<textarea id="updateTaskDescription" name="description" required></textarea>
						</div>
						<div style="display: flex; gap: 0.75rem; justify-content: flex-end">
							<button type="button" class="btn btn-secondary" onclick="closeEditModal()">
								<i class="fas fa-times"></i>
								Cancel
							</button>
							<button type="submit" class="btn btn-primary">
								<i class="fas fa-save"></i>
								Update Task
							</button>
						</div>
					</form>
				</div>
			</div>
		</div>

		<script>
			const API_BASE_URL = "http://localhost:8000";
			let allTasks = [];
			let currentFilter = "all";
			let currentSort = "id";
			let searchTerm = "";

			// Toast notification system
			function showToast(message, type = "success") {
				const toast = document.createElement("div");
				toast.className = `toast ${type}`;

				const icon = type === "success" ? "fas fa-check-circle" : "fas fa-exclamation-circle";
				toast.innerHTML = `
                <i class="${icon}"></i>
                <span>${message}</span>
            `;

				document.getElementById("toastContainer").appendChild(toast);

				setTimeout(() => {
					toast.style.animation = "toastOut 0.3s ease forwards";
					setTimeout(() => toast.remove(), 300);
				}, 4000);
			}

			// Update statistics
			function updateStats() {
				const total = allTasks.length;
				const completed = allTasks.filter((task) => task.completed).length;
				const pending = total - completed;

				document.getElementById("totalTasks").textContent = total;
				document.getElementById("pendingTasks").textContent = pending;
				document.getElementById("completedTasks").textContent = completed;
			}

			// Load and display tasks
			async function loadTasks(completed = null) {
				const container = document.getElementById("tasksContainer");
				container.innerHTML = `
                <div class="loading">
                    <div class="spinner"></div>
                    <p>Loading your tasks...</p>
                </div>
            `;

				try {
					let url = `${API_BASE_URL}/tasks`;
					if (completed !== null) {
						url += `?completed=${completed}`;
					}

					const response = await fetch(url);
					if (!response.ok) {
						throw new Error(`HTTP error! status: ${response.status}`);
					}

					const data = await response.json();
					allTasks = data.tasks;
					updateStats();
					applyFiltersAndDisplay();
				} catch (error) {
					console.error("Error loading tasks:", error);
					container.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-exclamation-triangle"></i>
                        <h3>Failed to load tasks</h3>
                        <p>${error.message}</p>
                        <button class="btn btn-primary" onclick="loadTasks()">
                            <i class="fas fa-retry"></i>
                            Try Again
                        </button>
                    </div>
                `;
				}
			}

			// Apply filters and display tasks
			function applyFiltersAndDisplay() {
				let filteredTasks = [...allTasks];

				// Apply filter
				if (currentFilter === "pending") {
					filteredTasks = filteredTasks.filter((task) => !task.completed);
				} else if (currentFilter === "completed") {
					filteredTasks = filteredTasks.filter((task) => task.completed);
				}

				// Apply search
				if (searchTerm) {
					filteredTasks = filteredTasks.filter(
						(task) =>
							task.title.toLowerCase().includes(searchTerm.toLowerCase()) ||
							task.description.toLowerCase().includes(searchTerm.toLowerCase())
					);
				}

				// Apply sort
				filteredTasks.sort((a, b) => {
					if (currentSort === "id") {
						return a.id - b.id;
					} else if (currentSort === "title") {
						return a.title.localeCompare(b.title);
					}
					return 0;
				});

				displayTasks(filteredTasks);
			}

			// Display tasks in the UI
			function displayTasks(tasks) {
				const container = document.getElementById("tasksContainer");
				const countElement = document.getElementById("taskCount");

				countElement.textContent = `(${tasks.length})`;

				if (tasks.length === 0) {
					container.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-clipboard-list"></i>
                        <h3>No tasks found</h3>
                        <p>${
													allTasks.length === 0
														? "Create your first task to get started!"
														: "Try adjusting your filters or search terms."
												}</p>
                    </div>
                `;
					return;
				}

				const tasksHTML = tasks
					.map(
						(task) => `
                <div class="task-card ${task.completed ? "completed" : "pending"}">
                    <div class="task-header">
                        <span class="task-id">ID: ${task.id}</span>
                        <span class="task-status ${task.completed ? "completed" : "pending"}">
                            <i class="fas fa-${task.completed ? "check-circle" : "clock"}"></i>
                            ${task.completed ? "Completed" : "Pending"}
                        </span>
                    </div>
                    <div class="task-body">
                        <div class="task-title">${escapeHtml(task.title)}</div>
                        <div class="task-description">${escapeHtml(task.description)}</div>
                        <div class="task-actions">
                            <button class="btn btn-primary btn-sm" onclick="openEditModal(${task.id})">
                                <i class="fas fa-edit"></i>
                                Edit
                            </button>
                            <button class="btn btn-${task.completed ? "warning" : "success"} btn-sm" 
                                    onclick="toggleTaskStatus(${task.id}, ${!task.completed})">
                                <i class="fas fa-${task.completed ? "undo" : "check"}"></i>
                                ${task.completed ? "Mark Pending" : "Complete"}
                            </button>
                            <button class="btn btn-danger btn-sm" onclick="deleteTask(${task.id})">
                                <i class="fas fa-trash"></i>
                                Delete
                            </button>
                            <button class="btn btn-secondary btn-sm" onclick="viewTask(${task.id})">
                                <i class="fas fa-eye"></i>
                                View
                            </button>
                        </div>
                    </div>
                    <div class="task-meta">
                        <span><i class="fas fa-calendar"></i> Created recently</span>
                        <span><i class="fas fa-tag"></i> Priority: Normal</span>
                    </div>
                </div>
            `
					)
					.join("");

				container.innerHTML = `<div class="tasks-grid">${tasksHTML}</div>`;
			}

			// Escape HTML to prevent XSS
			function escapeHtml(text) {
				const div = document.createElement("div");
				div.textContent = text;
				return div.innerHTML;
			}

			// View task details
			async function viewTask(taskId) {
				try {
					const response = await fetch(`${API_BASE_URL}/tasks/${taskId}`);
					if (!response.ok) throw new Error("Task not found");

					const data = await response.json();
					const task = data.task;

					showToast(`Task "${task.title}" loaded successfully!`, "success");
					// Could open a detailed view modal here
					console.log("Task details:", task);
				} catch (error) {
					showToast("Failed to load task details", "error");
				}
			}

			// Open edit modal
			async function openEditModal(taskId) {
				try {
					const response = await fetch(`${API_BASE_URL}/tasks/${taskId}`);
					if (!response.ok) throw new Error("Task not found");

					const data = await response.json();
					const task = data.task;

					document.getElementById("updateTaskCurrentId").value = task.id;
					document.getElementById("updateTaskId").value = task.id;
					document.getElementById("updateTaskTitle").value = task.title;
					document.getElementById("updateTaskDescription").value = task.description;
					document.getElementById("updateTaskCompleted").value = task.completed.toString();

					document.getElementById("editModal").classList.add("show");
				} catch (error) {
					showToast("Failed to load task for editing", "error");
				}
			}

			// Close edit modal
			function closeEditModal() {
				document.getElementById("editModal").classList.remove("show");
			}

			// Toggle task completion status
			async function toggleTaskStatus(taskId, newStatus) {
				try {
					const response = await fetch(`${API_BASE_URL}/tasks/${taskId}`);
					if (!response.ok) throw new Error("Failed to fetch task");

					const taskData = await response.json();
					const task = taskData.task;

					const updateResponse = await fetch(`${API_BASE_URL}/tasks/${taskId}`, {
						method: "PUT",
						headers: { "Content-Type": "application/json" },
						body: JSON.stringify({
							id: task.id,
							title: task.title,
							description: task.description,
							completed: newStatus,
						}),
					});

					if (!updateResponse.ok) throw new Error("Failed to update task");

					showToast(`Task ${newStatus ? "completed" : "marked as pending"}!`, "success");
					loadTasks();
				} catch (error) {
					showToast("Failed to update task status", "error");
				}
			}

			// Delete task
			async function deleteTask(taskId) {
				if (!confirm("Are you sure you want to delete this task? This action cannot be undone.")) {
					return;
				}

				try {
					const response = await fetch(`${API_BASE_URL}/tasks/${taskId}`, {
						method: "DELETE",
					});

					if (!response.ok) throw new Error("Failed to delete task");

					showToast("Task deleted successfully!", "success");
					loadTasks();
				} catch (error) {
					showToast("Failed to delete task", "error");
				}
			}

			// Sort tasks
			function sortTasks(sortBy) {
				currentSort = sortBy;
				applyFiltersAndDisplay();
				showToast(`Tasks sorted by ${sortBy}`, "success");
			}

			// Quick action functions
			async function markAllCompleted() {
				if (!confirm("Mark all pending tasks as completed?")) return;

				const pendingTasks = allTasks.filter((task) => !task.completed);
				let successCount = 0;

				for (const task of pendingTasks) {
					try {
						const response = await fetch(`${API_BASE_URL}/tasks/${task.id}`, {
							method: "PUT",
							headers: { "Content-Type": "application/json" },
							body: JSON.stringify({ ...task, completed: true }),
						});
						if (response.ok) successCount++;
					} catch (error) {
						console.error("Failed to update task:", task.id);
					}
				}

				showToast(`${successCount} tasks marked as completed!`, "success");
				loadTasks();
			}

			async function markAllPending() {
				if (!confirm("Mark all completed tasks as pending?")) return;

				const completedTasks = allTasks.filter((task) => task.completed);
				let successCount = 0;

				for (const task of completedTasks) {
					try {
						const response = await fetch(`${API_BASE_URL}/tasks/${task.id}`, {
							method: "PUT",
							headers: { "Content-Type": "application/json" },
							body: JSON.stringify({ ...task, completed: false }),
						});
						if (response.ok) successCount++;
					} catch (error) {
						console.error("Failed to update task:", task.id);
					}
				}

				showToast(`${successCount} tasks marked as pending!`, "success");
				loadTasks();
			}

			async function deleteAllCompleted() {
				const completedTasks = allTasks.filter((task) => task.completed);
				if (completedTasks.length === 0) {
					showToast("No completed tasks to delete", "error");
					return;
				}

				if (!confirm(`Delete all ${completedTasks.length} completed tasks? This cannot be undone.`)) return;

				let successCount = 0;
				for (const task of completedTasks) {
					try {
						const response = await fetch(`${API_BASE_URL}/tasks/${task.id}`, {
							method: "DELETE",
						});
						if (response.ok) successCount++;
					} catch (error) {
						console.error("Failed to delete task:", task.id);
					}
				}

				showToast(`${successCount} completed tasks deleted!`, "success");
				loadTasks();
			}

			function exportTasks() {
				const dataStr = JSON.stringify(allTasks, null, 2);
				const dataBlob = new Blob([dataStr], { type: "application/json" });
				const url = URL.createObjectURL(dataBlob);
				const link = document.createElement("a");
				link.href = url;
				link.download = `tasks-export-${new Date().toISOString().split("T")[0]}.json`;
				link.click();
				URL.revokeObjectURL(url);
				showToast("Tasks exported successfully!", "success");
			}

			// Event listeners
			document.getElementById("createTaskForm").addEventListener("submit", async (e) => {
				e.preventDefault();

				const submitBtn = e.target.querySelector('button[type="submit"]');
				const originalText = submitBtn.innerHTML;
				submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Creating...';
				submitBtn.disabled = true;

				const formData = new FormData(e.target);
				const autoId = formData.get("autoId") === "true";

				const taskData = {
					id: autoId ? 1 : parseInt(formData.get("id")),
					title: formData.get("title"),
					description: formData.get("description"),
					completed: formData.get("completed") === "true",
				};

				try {
					const response = await fetch(`${API_BASE_URL}/tasks?auto_id=${autoId}`, {
						method: "POST",
						headers: { "Content-Type": "application/json" },
						body: JSON.stringify(taskData),
					});

					if (!response.ok) {
						const errorData = await response.json();
						throw new Error(errorData.detail || "Failed to create task");
					}

					showToast("Task created successfully!", "success");
					e.target.reset();
					loadTasks();
				} catch (error) {
					showToast(`Failed to create task: ${error.message}`, "error");
				} finally {
					submitBtn.innerHTML = originalText;
					submitBtn.disabled = false;
				}
			});

			document.getElementById("updateTaskForm").addEventListener("submit", async (e) => {
				e.preventDefault();

				const formData = new FormData(e.target);
				const currentId = parseInt(formData.get("currentId"));
				const newId = formData.get("id") ? parseInt(formData.get("id")) : currentId;

				const taskData = {
					id: newId,
					title: formData.get("title"),
					description: formData.get("description"),
					completed: formData.get("completed") === "true",
				};

				try {
					const response = await fetch(`${API_BASE_URL}/tasks/${currentId}`, {
						method: "PUT",
						headers: { "Content-Type": "application/json" },
						body: JSON.stringify(taskData),
					});

					if (!response.ok) {
						const errorData = await response.json();
						throw new Error(errorData.detail || "Failed to update task");
					}

					showToast("Task updated successfully!", "success");
					closeEditModal();
					loadTasks();
				} catch (error) {
					showToast(`Failed to update task: ${error.message}`, "error");
				}
			});

			// Auto ID toggle
			document.getElementById("autoId").addEventListener("change", (e) => {
				const taskIdInput = document.getElementById("taskId");
				if (e.target.value === "true") {
					taskIdInput.disabled = true;
					taskIdInput.placeholder = "Auto-generated";
					taskIdInput.required = false;
					taskIdInput.value = "";
				} else {
					taskIdInput.disabled = false;
					taskIdInput.placeholder = "Enter ID";
					taskIdInput.required = true;
				}
			});

			// Filter tabs
			document.querySelectorAll(".filter-tab").forEach((tab) => {
				tab.addEventListener("click", (e) => {
					document.querySelectorAll(".filter-tab").forEach((t) => t.classList.remove("active"));
					e.target.classList.add("active");
					currentFilter = e.target.dataset.filter;
					applyFiltersAndDisplay();
				});
			});

			// Search input
			document.getElementById("searchInput").addEventListener("input", (e) => {
				searchTerm = e.target.value;
				applyFiltersAndDisplay();
			});

			// Modal close on outside click
			document.getElementById("editModal").addEventListener("click", (e) => {
				if (e.target.id === "editModal") {
					closeEditModal();
				}
			});

			// Initialize
			document.addEventListener("DOMContentLoaded", () => {
				loadTasks();

				// Trigger auto ID change on load
				document.getElementById("autoId").dispatchEvent(new Event("change"));
			});

			// Auto refresh every 30 seconds
			setInterval(() => {
				loadTasks();
			}, 30000);
		</script>
	</body>
</html>
